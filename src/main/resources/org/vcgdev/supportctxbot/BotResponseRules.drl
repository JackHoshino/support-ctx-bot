package org.vcgdev.supportctxbot
import java.util.List
import org.slf4j.Logger
import kie.MessageResponse
import kie.ConversationContext
global List elegibleResponses
global ConversationContext conversationContext
rule "Hello intent"
    when $a:MessageResponse(intent=="hello")
    then
        $a.setResponse("Hola {name}, en que puedo ayudate");
     end
rule "Bye intent"
    when $a:MessageResponse(intent=="bye")
    then
        $a.setResponse("Hasta luego {name}!");
     end
rule "Request name intent"
    when $a:MessageResponse(intent=="send_description")
    then
        $a.setResponse("Gracias por preguntar {name}, mi nombre es Luky, y por el momento puedo ayudarte a clasificar el problema de soporte que tengas y guardarlo en el sistema Asigno!, En que te puedo ayudar?");
     end
rule "Thanks intent"
    when $a:MessageResponse(intent=="thanks")
    then
        elegibleResponses.add("thanks");
     end
rule "PC is slow intent"
    when $a:MessageResponse(intent=="pc_slow")
    then
        elegibleResponses.add("pc_slow");
        //conversationContext.setContext("Pc is really slow");
     end
rule "Printer error intent"
    when $a:MessageResponse(intent=="printer_error")
    then
        elegibleResponses.add("printer_error");
     end
rule "Create mail box intent"
 when $a:MessageResponse(intent=="mail_create_account")
      $b:ConversationContext(context=="")
  then
    elegibleResponses.add("mail_create_account");
    modify($b){setContext("require_mails")};
    System.out.println("Set context to require_mails "+$b);
  end//en esta regla ver si vienen los correos a crear, si no mandar un mensaje -->
rule "Detect mails to create"
when $a:ConversationContext(context=="require_mails")
    $b:MessageResponse(entities().contains("email"))
then
 elegibleResponses.add("We now know emails to create");
 end
rule "Intent inbox error"
    when $a:MessageResponse(intent=="mail_error" && entities().contains("mail_folder_inbox"))
    then
        elegibleResponses.add("inbox_error");
     end
rule "Intent outbox error"
    when $a:MessageResponse(intent=="mail_error" && entities().contains("mail_folder_outbox"))
    then
        elegibleResponses.add("mail_outbox");
      end
rule "Intent mail error unknow box"
    when $a:MessageResponse(intent=="mail_error",!entities().contains("mail_folder_outbox"),!entities().contains("mail_folder_inbox"))
    then
        elegibleResponses.add("mail_unknow_box");
     end


